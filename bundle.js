!function(t){function e(i){if(s[i])return s[i].exports;var a=s[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var s={};return e.m=t,e.c=s,e.p="",e(0)}([function(t,e,s){"use strict";console.clear();var i=s(1),a=s(2),n=s(3),r=s(4),o={rows:50,iterations:50,diffusion:.999,speed:10,pushStrength:50,pushAmount:150,red:1300,green:255,blue:1300},h=window.top.fluid=new i(o),u=new a(o),l=window.top.particles=new n(o);new r({reset:function(){h.reset(),l.reset()},loop:function(){h.iterate(),l.iterate(h),u.renderFluid(h),u.renderParticles(l)}}),u.topCanvas.onmousemove=function(t){var e=t.offsetX/u.width,s=t.offsetY/u.width,i=t.movementX/u.width,a=t.movementY/u.width;h.interact(e,s,i,a)};var c=new window.dat.GUI;c.add(o,"rows",50,300).step(1).onChange(function(){return h.reset()}),c.add(o,"iterations",1,200),c.add(o,"diffusion",.99,1),c.add(o,"speed",0,100),c.add(o,"pushAmount",0,1e3),c.add(o,"pushStrength",0,100)},function(t,e){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),a=function(){function t(e){s(this,t),this.params=e,this.reset()}return i(t,[{key:"reset",value:function(){var t=this.params.rows,e=t*t;this.xs=new Float32Array(e),this.ys=new Float32Array(e),this.dn=new Float32Array(e),this.temps=[new Float32Array(e),new Float32Array(e),new Float32Array(e)],this.up=new Uint16Array(e),this.dw=new Uint16Array(e),this.lt=new Uint16Array(e),this.rt=new Uint16Array(e);for(var s=0;s<t;s++)for(var i=0;i<t;i++){var e=s*t+i;this.up[e]=t*((s-1+t)%t)+i,this.dw[e]=t*((s+1)%t)+i,this.lt[e]=t*s+(i-1+t)%t,this.rt[e]=t*s+(i+1)%t}}},{key:"iterate",value:function(){this.diffuse();var t=this.calculatePressures(),e=this.calculateCummulativePressures(t);this.calculateVelocities(e),this.advect()}},{key:"diffuse",value:function(){for(var t=this.params.diffusion,e=this.xs,s=this.ys,i=this.dn,a=0;a<i.length;a++)e[a]*=t,s[a]*=t,i[a]*=t}},{key:"calculatePressures",value:function(){for(var t=this.temps,e=this.xs,s=this.ys,i=this.up,a=this.dw,n=this.lt,r=this.rt,o=t[0],h=0;h<e.length;h++)o[h]=e[n[h]]-e[r[h]]+s[i[h]]-s[a[h]];return o}},{key:"calculateCummulativePressures",value:function(t){var e,s,i,a=this.params.iterations,n=this.temps,r=this.up,o=this.dw,h=this.lt,u=this.rt,l=n[1],c=n[2];for(l.fill(0),e=0;e<a;e++){for(s=0;s<l.length;s++)c[s]=(t[s]+l[h[s]]+l[u[s]]+l[r[s]]+l[o[s]])/4;i=l,l=c,c=i}return l}},{key:"calculateVelocities",value:function(t){for(var e=this.xs,s=this.ys,i=this.up,a=this.dw,n=this.lt,r=this.rt,o=0;o<e.length;o++)e[o]+=(t[n[o]]-t[r[o]])/2,s[o]+=(t[i[o]]-t[a[o]])/2}},{key:"advect",value:function(){for(var t=this.params,e=t.rows,s=t.speed,i=this.xs,a=this.ys,n=this.dn,r=this.temps,o=this.rt,h=this.dw,u=[i,a,n],l=0;l<e;l++)for(var c=0;c<e;c++)for(var f=l*e+c,d=c-s*i[f],p=l-s*a[f],v=Math.floor(d),w=Math.floor(p),m=d-v,y=p-w,x=(w+1e6*e)%e*e+(v+1e6*e)%e,b=0;b<u.length;b++){var g=u[b],C=r[b];C[f]=(1-m)*((1-y)*g[x]+y*g[h[x]])+m*((1-y)*g[o[x]]+y*g[h[o[x]]])}var k=[r[0],i];this.xs=k[0],this.temps[0]=k[1];var A=[r[1],a];this.ys=A[0],this.temps[1]=A[1];var F=[r[2],n];this.dn=F[0],this.temps[2]=F[1]}},{key:"interact",value:function(t,e,s,i){var a=this.params,n=a.rows,r=a.pushStrength,o=a.pushAmount,h=a.speed;s*=n,i*=n;for(var u=Math.max(1,Math.sqrt(s*s+i*i)),l=r*u/n/h,c=0;c<u;c++){var f=Math.floor(n*t+c/u*s),d=Math.floor(n*e+c/u*i),p=f+d*n;this.xs[p]=s*l,this.ys[p]=i*l,this.dn[p]=o/n}}}]),t}();t.exports=a},function(t,e){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),a=function(){function t(e){var i=this;s(this,t),this.params=e,this.bottomCanvas=document.createElement("canvas"),this.bottomCtx=this.bottomCanvas.getContext("2d",{alpha:!1}),document.body.appendChild(this.bottomCanvas),this.topCanvas=document.createElement("canvas"),this.topCanvas.style.position="absolute",this.topCanvas.style.top=this.topCanvas.style.left=0,this.topCtx=this.topCanvas.getContext("2d"),document.body.appendChild(this.topCanvas),window.onresize=function(){return i.resize()},this.resize()}return i(t,[{key:"resize",value:function(){this.width=this.topCanvas.width=this.topCanvas.height=Math.min(window.innerWidth,window.innerHeight),this.bottomCanvas.style.width=this.bottomCanvas.style.height=this.width+"px"}},{key:"renderFluid",value:function(t){var e=this.params.rows,s=this.bottomCtx,i=this.bottomCanvas;if(this.rows!=e){this.rows=i.width=i.height=e,this.imageData=s.createImageData(this.rows,this.rows);for(var a=3;a<this.imageData.data.length;a+=4)this.imageData.data[a]=255}for(var n=this.imageData.data,a=0;a<t.xs.length;a++)n[4*a+0]=0|Math.abs(t.xs[a]*this.params.red),n[4*a+1]=t.dn[a]*this.params.green|0,n[4*a+2]=0|Math.abs(t.ys[a]*this.params.blue);s.putImageData(this.imageData,0,0)}},{key:"renderParticles",value:function(t){var e=this.topCtx,s=this.width/this.params.rows;e.clearRect(0,0,this.width,this.width),e.strokeStyle="white",e.save(),e.scale(s,s),e.lineWidth=1/s,e.beginPath();for(var i=t.num,a=t.xc,n=t.yc,r=t.px,o=t.py,h=0;h<i;h++)e.moveTo(r[h],o[h]),e.lineTo(a[h],n[h]);e.stroke(),e.restore()}}]),t}();t.exports=a},function(t,e){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),a=function(){function t(e){s(this,t),this.params=e,this.num=5e3,this.xc=new Float32Array(this.num),this.yc=new Float32Array(this.num),this.px=new Float32Array(this.num),this.py=new Float32Array(this.num)}return i(t,[{key:"reset",value:function(){for(var t=this.params.rows,e=0;e<this.num;e++)this.xc[e]=this.px[e]=Math.random()*t,this.yc[e]=this.py[e]=Math.random()*t}},{key:"iterate",value:function(t){for(var e=this.params,s=e.rows,i=e.speed,a=this.xc,n=this.yc,r=this.px,o=this.py,h=this.num,u=0;u<h;u++){var l=s*Math.floor(n[u])+Math.floor(a[u]);r[u]=a[u],o[u]=n[u],a[u]+=t.xs[l]*i,n[u]+=t.ys[l]*i,(a[u]<0||a[u]>=s||n[u]<0||n[u]>=s)&&(a[u]=r[u]=(a[u]+s)%s,n[u]=o[u]=(n[u]+s)%s)}}}]),t}();t.exports=a},function(t,e){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function a(t){function e(){t.loop(),i||requestAnimationFrame(e)}s(this,a);var i=!1;window.ondblclick=function(){return t.reset()},window.onblur=function(){return i=!0},window.onfocus=function(){i&&(i=!1,e())},t.reset(),e()};t.exports=i}]);