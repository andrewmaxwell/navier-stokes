!function(t){function e(i){if(s[i])return s[i].exports;var n=s[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var s={};return e.m=t,e.c=s,e.p="",e(0)}([function(t,e,s){"use strict";console.clear();var i=s(1),n=s(2),a=s(3),r=s(4),o={rows:50,iterations:25,diffusion:.999,speed:10,pushStrength:50,pushAmount:150,red:1300,green:255,blue:1300},h=window.top.fluid=new i(o),u=new n(o),c=window.top.particles=new a(o);new r({reset:function(){h.reset(),c.reset()},loop:function(){h.iterate(),c.iterate(h),u.renderFluid(h),u.renderParticles(c)}}),u.topCanvas.onmousemove=function(t){var e=t.offsetX/u.width,s=t.offsetY/u.width,i=t.movementX/u.width,n=t.movementY/u.width;h.interact(e,s,i,n)};var l=new window.dat.GUI;l.add(o,"rows",10,100).step(1).onChange(function(){return h.reset()}),l.add(o,"iterations",1,200),l.add(o,"diffusion",.99,1),l.add(o,"speed",0,100),l.add(o,"pushAmount",0,1e3),l.add(o,"pushStrength",0,100)},function(t,e){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),n=function(){function t(e){s(this,t),this.params=e,this.reset()}return i(t,[{key:"reset",value:function(){var t=this.params.rows,e=t*t;this.xs=new Float32Array(e),this.ys=new Float32Array(e),this.pr=new Float32Array(e),this.dn=new Float32Array(e),this.temps=[new Float32Array(e),new Float32Array(e),new Float32Array(e)],this.up=new Uint16Array(e),this.dw=new Uint16Array(e),this.lt=new Uint16Array(e),this.rt=new Uint16Array(e);for(var s=0;s<t;s++)for(var i=0;i<t;i++){var n=s*t+i;this.up[n]=t*((s-1+t)%t)+i,this.dw[n]=t*((s+1)%t)+i,this.lt[n]=t*s+(i-1+t)%t,this.rt[n]=t*s+(i+1)%t}}},{key:"iterate",value:function(){this.diffuse(),this.calculatePressures(),this.calculateVelocities(),this.advect()}},{key:"diffuse",value:function(){for(var t=this.params.diffusion,e=this.xs,s=this.ys,i=this.dn,n=0;n<i.length;n++)e[n]*=t,s[n]*=t,i[n]*=t}},{key:"calculatePressures",value:function(){var t,e,s=this.params.iterations,i=this.xs,n=this.ys,a=this.pr,r=this.temps,o=this.up,h=this.dw,u=this.lt,c=this.rt,l=r[0],f=r[1];for(e=0;e<i.length;e++)a[e]=l[e]=i[u[e]]-i[c[e]]+n[o[e]]-n[h[e]];for(t=0;t<s;t++){for(e=0;e<a.length;e++)f[e]=(l[e]+a[u[e]]+a[c[e]]+a[o[e]]+a[h[e]])/4;for(e=0;e<a.length;e++)a[e]=(l[e]+f[u[e]]+f[c[e]]+f[o[e]]+f[h[e]])/4}}},{key:"calculateVelocities",value:function(){for(var t=this.xs,e=this.ys,s=this.pr,i=this.up,n=this.dw,a=this.lt,r=this.rt,o=0;o<t.length;o++)t[o]+=(s[a[o]]-s[r[o]])/2,e[o]+=(s[i[o]]-s[n[o]])/2}},{key:"advect",value:function(){for(var t=this.params,e=t.rows,s=t.speed,i=this.xs,n=this.ys,a=this.dn,r=this.temps,o=this.rt,h=this.dw,u=[i,n,a],c=0;c<e;c++)for(var l=0;l<e;l++)for(var f=c*e+l,p=l-s*i[f],d=c-s*n[f],v=Math.floor(p),w=Math.floor(d),m=p-v,y=d-w,x=(w+1e6*e)%e*e+(v+1e6*e)%e,g=0;g<u.length;g++){var b=u[g],C=r[g];C[f]=(1-m)*((1-y)*b[x]+y*b[h[x]])+m*((1-y)*b[o[x]]+y*b[h[o[x]]])}var A=[r[0],i];this.xs=A[0],this.temps[0]=A[1];var k=[r[1],n];this.ys=k[0],this.temps[1]=k[1];var F=[r[2],a];this.dn=F[0],this.temps[2]=F[1]}},{key:"interact",value:function(t,e,s,i){var n=this.params,a=n.rows,r=n.pushStrength,o=n.pushAmount,h=n.speed;s*=a,i*=a;for(var u=Math.max(1,Math.sqrt(s*s+i*i)),c=r*u/a/h,l=0;l<u;l++){var f=Math.floor(a*t+l/u*s),p=Math.floor(a*e+l/u*i),d=f+p*a;this.xs[d]=s*c,this.ys[d]=i*c,this.dn[d]=o/a}}}]),t}();t.exports=n},function(t,e){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),n=function(){function t(e){var i=this;s(this,t),this.params=e,this.bottomCanvas=document.createElement("canvas"),this.bottomCtx=this.bottomCanvas.getContext("2d",{alpha:!1}),document.body.appendChild(this.bottomCanvas),this.topCanvas=document.createElement("canvas"),this.topCanvas.style.position="absolute",this.topCanvas.style.top=this.topCanvas.style.left=0,this.topCtx=this.topCanvas.getContext("2d"),document.body.appendChild(this.topCanvas),window.onresize=function(){return i.resize()},this.resize()}return i(t,[{key:"resize",value:function(){this.width=this.topCanvas.width=this.topCanvas.height=Math.min(window.innerWidth,window.innerHeight),this.bottomCanvas.style.width=this.bottomCanvas.style.height=this.width+"px"}},{key:"renderFluid",value:function(t){var e=this.params.rows,s=this.bottomCtx,i=this.bottomCanvas;if(this.rows!=e){this.rows=i.width=i.height=e,this.imageData=s.createImageData(this.rows,this.rows);for(var n=3;n<this.imageData.data.length;n+=4)this.imageData.data[n]=255}for(var a=this.imageData.data,n=0;n<t.xs.length;n++)a[4*n+0]=0|Math.abs(t.xs[n]*this.params.red),a[4*n+1]=t.dn[n]*this.params.green|0,a[4*n+2]=0|Math.abs(t.ys[n]*this.params.blue);s.putImageData(this.imageData,0,0)}},{key:"renderParticles",value:function(t){var e=this.topCtx,s=this.width/this.params.rows;e.clearRect(0,0,this.width,this.width),e.strokeStyle="white",e.save(),e.scale(s,s),e.lineWidth=1/s,e.beginPath();for(var i=t.num,n=t.xc,a=t.yc,r=t.px,o=t.py,h=0;h<i;h++)e.moveTo(r[h],o[h]),e.lineTo(n[h],a[h]);e.stroke(),e.restore()}}]),t}();t.exports=n},function(t,e){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),n=function(){function t(e){s(this,t),this.params=e,this.num=5e3,this.xc=new Float32Array(this.num),this.yc=new Float32Array(this.num),this.px=new Float32Array(this.num),this.py=new Float32Array(this.num)}return i(t,[{key:"reset",value:function(){for(var t=this.params.rows,e=0;e<this.num;e++)this.xc[e]=this.px[e]=Math.random()*t,this.yc[e]=this.py[e]=Math.random()*t}},{key:"iterate",value:function(t){for(var e=this.params,s=e.rows,i=e.speed,n=this.xc,a=this.yc,r=this.px,o=this.py,h=this.num,u=0;u<h;u++){var c=s*Math.floor(a[u])+Math.floor(n[u]);r[u]=n[u],o[u]=a[u],n[u]+=t.xs[c]*i,a[u]+=t.ys[c]*i,(n[u]<0||n[u]>=s||a[u]<0||a[u]>=s)&&(n[u]=r[u]=(n[u]+s)%s,a[u]=o[u]=(a[u]+s)%s)}}}]),t}();t.exports=n},function(t,e){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function n(t){function e(){t.loop(),i||requestAnimationFrame(e)}s(this,n);var i=!1;window.ondblclick=function(){return t.reset()},window.onblur=function(){return i=!0},window.onfocus=function(){i&&(i=!1,e())},t.reset(),e()};t.exports=i}]);